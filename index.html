<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Proof of Trace</title>
  <link rel="stylesheet" href="./style.css?v=<?php echo time(); ?>" />


<meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<body>
<!-- partial:index.partial.html -->
<div id="app"></div>

<div id="controls">
  <button id="shufflepuzzle" name="shufflepuzzle">Shuffle</button>
  <button name="resetpuzzle">Reset</button>
  <select name="pickimage" style ="display: none;"">
    <option value="https://media.licdn.com/dms/image/v2/D4E0BAQFHzf5DbAVGzA/company-logo_200_200/company-logo_200_200/0/1703608227111?e=2147483647&v=beta&t=RfR9-BnExCcz5G0rDOhTK6Lvns2ASOfqK0og_smQ1uE" selected="selected">Blank</option>
  </select>
  <select name="boardconfig" id="boardconfig">
    <option value="3x2" selected="selected">3 x 2    </option>
    <option value="2x3">2 x 3</option>
    <option value="3x3">3 x 3</option>
    <option value="4x3">4 x 3</option>
    <option value="3x4">3 x 4</option>
    <option value="5x7">5 x 7</option>
    <option value="7x5">7 x 5</option>
  </select>
  <div id="action-traces">
    <strong>Action Traces:</strong>
  </div>

</div>




<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js'></script><script  src="./script.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        document.querySelector('button[name=shufflepuzzle]').click();
      }, 1000);
    });
    </script>
    

    <script>
      (function() {
        // Access the canvas element without conflicting variable names
        const puzzleCanvas = document.querySelector('#app canvas');
        let isDragging = false;
        let moveLog = [];
        let startX = 0;
        let startY = 0;
    
        // Listen for pointerdown event
        puzzleCanvas.addEventListener('pointerdown', function(e) {
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
        });
    
        // Listen for pointerup event
        puzzleCanvas.addEventListener('pointerup', function(e) {
          if (isDragging) {
            isDragging = false;
            let endX = e.clientX;
            let endY = e.clientY;
    
            // Log the move
            moveLog.push({
              from: { x: startX, y: startY },
              to: { x: endX, y: endY },
              timestamp: new Date().toLocaleTimeString()
            });
    
            console.log(`Moved from (${startX}, ${startY}) to (${endX}, ${endY})`);
    
            // Update the action traces div after each move
            showMoveLog();
    
            // Reset positions
            startX = 0;
            startY = 0;
          }
        });
    
        // Updated function to display the move log in the div
        function showMoveLog() {
          // Start with the heading
          let logContent = '<strong>Action Traces:</strong><br>';
    
          // Reverse the moveLog array to show latest moves first
          let reversedMoveLog = moveLog.slice().reverse();
    
          // Append new moves
          for (let move of reversedMoveLog) {
            logContent += `${move.timestamp}, moved from (${move.from.x}, ${move.from.y}) to (${move.to.x}, ${move.to.y})<br>`;
          }
    
          // Update the content of the action-traces div
          document.getElementById('action-traces').innerHTML = logContent;
        }
    
        // Expose the function to the global scope if you want to trigger it manually
        window.showMoveLog = showMoveLog;
    
      })();
    </script>
    
    
    

</body>
</html>
